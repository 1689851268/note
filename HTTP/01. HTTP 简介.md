# HTTP

HTTP（Hypertext Transfer Protocol）是一种用于在 Web 上进行数据传输的协议。它是一种无状态的协议，使用客户端-服务器模型进行通信。HTTP 通常用于在浏览器和服务器之间传输超文本（HTML、CSS、JavaScript）、图像、音视频等资源。

<br>

HTTP 协议的特点和功能包括：

1.  无连接：每个 HTTP 请求都是独立的，服务器不会保持与客户端的持续连接。每个请求都是独立的事务，服务器在响应请求后会关闭连接。这种无连接的特点使得 HTTP 可以灵活地适应大规模的分布式环境。

2.  无状态：HTTP 协议本身是无状态的，服务器不会保存客户端的状态信息。每个请求和响应之间是相互独立的，服务器不会知道之前的请求历史。为了处理状态，通常使用 Cookie、会话管理或其他机制来在客户端和服务器之间维护状态。

3.  请求-响应模型：HTTP 使用请求-响应模型进行通信。客户端发送一个 HTTP 请求给服务器，服务器处理请求并返回一个 HTTP 响应。请求和响应都包含头部信息和可选的消息体。

4.  可扩展性：HTTP 协议支持扩展，可以通过自定义的请求方法、头部信息、状态码等来满足不同的需求。

5.  缓存：HTTP 协议支持缓存机制，可以通过设置缓存头部信息来提高性能和减少网络带宽的消耗。

6.  安全性：HTTP 协议本身不具备安全性，但可以通过 HTTPS（HTTP over SSL/TLS）协议来加密通信，保护数据的安全性。

<br><br>

# HTTP2

HTTP2 是 HTTP 协议的一个升级版本，它在性能、效率和安全性方面有着显著的改进。HTTP2 在 2015 年正式发布，并逐渐被广泛采用。

<br>

HTTP2 的一些重要特性和改进如下：

1. 多路复用（Multiplexing）：HTTP2 支持在单个 TCP 连接上同时发送多个请求和接收多个响应，通过多路复用减少了连接建立和关闭的开销，提高了资源利用率。

2. 二进制传输（Binary Framing）：HTTP2 使用二进制格式对数据进行帧封装和传输，取代了原来的文本格式。这种二进制格式的编码和解码更高效，减少了开销和解析时间。

3. 头部压缩（Header Compression）：HTTP2 使用 HPACK 压缩算法对请求和响应头部进行压缩，减少了数据的传输量。压缩后的头部信息在客户端和服务器之间进行缓存和重用，提高了传输效率。

4. 服务器推送（Server Push）：HTTP2 支持服务器主动推送资源给客户端，无需客户端明确请求。服务器可以根据请求的资源关联性提前推送相关资源，减少了客户端的等待时间和额外的请求。

5. 流量控制（Flow Control）：HTTP2 引入了流量控制机制，允许客户端和服务器之间对数据流的流量进行控制，防止过载和拥塞。

6. 请求优先级（Priority）：HTTP2 支持对请求设置优先级，以确保重要资源的优先传输，提高页面渲染的速度和性能。

7. 头部重置（Header Reset）：HTTP2 允许客户端和服务器重置之前发送的头部信息，以提高错误处理和恢复的能力。

HTTP2 在保持与 HTTP1.1 兼容的同时，通过改进传输方式、优化效率和增强安全性，提升了网络通信的性能和用户体验。

<br><br>

# HTTPS

HTTPS（Hypertext Transfer Protocol Secure）是基于安全套接层（SSL）或传输层安全（TLS）协议的安全版本的 HTTP 协议。它通过使用加密和身份验证机制，确保在客户端和服务器之间进行的数据传输是安全的。

<br>

HTTPS 的工作原理如下：

1. 握手阶段：客户端发起 HTTPS 请求时，服务器会返回一个数字证书（Digital Certificate），证书包含服务器的公钥和其他相关信息。客户端会验证证书的有效性，包括证书的签名是否可信、证书是否过期等。

2. 密钥交换：如果证书有效，客户端生成一个随机的对称密钥（Session Key），并使用服务器的公钥进行加密。服务器收到加密的对称密钥后，使用私钥进行解密，获得对称密钥。

3. 数据传输：之后，客户端和服务器使用对称密钥进行加密和解密通信数据，保证数据的机密性。对称密钥只在当前会话中使用，并且每个会话都使用新的随机对称密钥，增加了数据传输的安全性。

<br>

HTTPS 的优势和特点包括：

1. 数据加密：HTTPS 使用 SSL/TLS 协议对数据进行加密，防止数据在传输过程中被窃听和篡改。加密算法的选择取决于服务器和客户端之间的协商。

2. 身份验证：HTTPS 使用数字证书来验证服务器的身份，确保客户端与服务器之间建立的连接是可信的。证书颁发机构（CA）对服务器的身份进行验证，并对证书进行签名，客户端可以通过验证证书的签名来确保服务器的身份。

3. 数据完整性：HTTPS 使用消息摘要算法（如 SHA）来确保传输的数据在传输过程中没有被篡改或损坏。客户端和服务器会对传输的数据进行校验，以确保数据的完整性。

4. 改善搜索引擎排名：搜索引擎通常会倾向于显示和推荐使用 HTTPS 的网站，因为它们更安全。

<br><br>

# 混合加密

混合加密是一种常见的加密方式，结合了对称加密和非对称加密两种方法的优势，用于在安全通信中保护数据的机密性和安全性。

<br>

混合加密的工作流程如下：

1. 非对称加密密钥交换：首先，使用非对称加密算法，如 RSA 或 ECC，进行密钥交换。发送方生成一对密钥：公钥和私钥。发送方将公钥发送给接收方，而私钥保密保存。接收方使用发送方的公钥对生成的共享密钥进行加密，并发送给发送方。

2. 对称加密数据传输：发送方和接收方都获得了相同的共享密钥。此时，数据传输的过程可以使用对称加密算法（如 AES 或 DES）进行加密和解密。发送方使用共享密钥对要传输的数据进行加密，然后将加密后的数据发送给接收方。

3. 解密和验证：接收方使用共享密钥对接收到的数据进行解密，恢复原始数据。通过这种方式，保证了数据的机密性。同时，接收方也可以使用自己的私钥对数字签名进行验证，以确保数据的完整性和身份验证。

<br>

混合加密的优点在于它结合了对称加密和非对称加密的优势：

-   非对称加密用于密钥交换，解决了密钥分发的问题。通过使用非对称加密算法，发送方可以安全地将共享密钥传输给接收方，而不用担心被窃听者获取密钥。
-   对称加密用于数据传输，提供了高效的加解密过程。由于对称加密算法计算速度快，因此可以更高效地加密和解密大量的数据。

通过混合加密，可以在保证通信安全的同时提供高效的数据传输。这种方法被广泛应用于安全通信、加密协议、安全电子邮件等领域，以确保数据的保密性和完整性。

<br><br>

# 三握四挥

"三握四挥" 是 TCP 协议中建立和断开连接的过程。

<br>

1. 三次握手：

    - 第一步：客户端发送一个请求给服务器，询问是否可以建立连接。
    - 第二步：服务器收到请求后，回复客户端，表示可以建立连接。
    - 第三步：客户端收到服务器的回复后，再次回复服务器，确认连接建立。

<br>

2. 四次挥手：
    - 第一步：客户端发送请求给服务器，请求断开连接。
    - 第二步：服务器接收到请求后，回复客户端，表示收到了请求，但还没有准备好断开连接。
    - 第三步：服务器准备好断开连接时，发送请求给客户端，告诉客户端可以断开连接。
    - 第四步：客户端收到服务器的请求后，回复服务器，确认断开连接。

<br>

通过 "三握四挥" 的过程，客户端和服务器建立和断开连接时都进行了双方的确认，确保连接的可靠性和准确性。这种方式可以保证数据的正确传输，并且在断开连接时，双方都能安全地关闭连接。

<br><br>

# HTTP 状态码

HTTP 状态码为客户端和服务器提供了一个统一的标准，使得双方能够准确地了解请求的处理结果。客户端可以根据不同的状态码采取相应的处理方式，如重试请求、显示错误信息等。服务器通过状态码向客户端传递必要的信息，以便进行适当的响应。

<br>

HTTP 状态码的分类如下：

-   1xx 信息类（Informational）：表示请求已被接收，继续处理。
-   2xx 成功类（Success）：表示请求已成功被服务器接收、理解和处理。
-   3xx 重定向类（Redirection）：表示需要客户端采取进一步的操作才能完成请求。
-   4xx 客户端错误类（Client Error）：表示客户端发送的请求有错误。
-   5xx 服务器错误类（Server Error）：表示服务器在处理请求时发生了错误。

<br>

| 状态码  | 状态码英文名称                  | 中文描述                                                                                                                                                        |
| ------- | ------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 100     | Continue                        | 继续。客户端应继续其请求                                                                                                                                        |
| 101     | Switching Protocols             | 切换协议。服务器根据客户端的请求切换协议。只能切换到更高级的协议。<br />例如，切换到 HTTP 的新版本协议                                                          |
|         |                                 |                                                                                                                                                                 |
| 200     | OK                              | 请求成功。一般用于 GET 与 POST 请求                                                                                                                             |
| **201** | **Created**                     | **已创建。成功请求并创建了新的资源**                                                                                                                            |
| 202     | Accepted                        | 已接受。已经接受请求，但未处理完成                                                                                                                              |
| 203     | Non-Authoritative Information   | 非授权信息。请求成功。但返回的 meta 信息不在原始的服务器，而是一个副本                                                                                          |
| 204     | No Content                      | 无内容。服务器成功处理，但未返回内容。在未更新网页的情况下，可确保浏览器继续显示当前文档                                                                        |
| 205     | Reset Content                   | 重置内容。服务器处理成功，用户终端（例如：浏览器）应重置文档视图。可通过此返回码清除浏览器的表单域                                                              |
| 206     | Partial Content                 | 部分内容。服务器成功处理了部分 GET 请求（分片）                                                                                                                 |
|         |                                 |                                                                                                                                                                 |
| 300     | Multiple Choices                | 多种选择。请求的资源可包括多个位置，可返回一个资源特征与地址的列表，用于用户终端选择                                                                            |
| **301** | **Moved Permanently**           | **永久移动。请求的资源已被永久的移动到新 URI，返回的信息也会包括新 URI。浏览器会自动重定向到新 URI。今后任何请求都应使用新 URI 代替**                           |
| **302** | **Found**                       | **临时移动。与 301 类似，但资源只是临时被移动。客户端应继续使用原有 URI**                                                                                       |
| 303     | See Other                       | 查看其它地址。与 301 类似。使用 GET 和 POST 请求查看                                                                                                            |
| **304** | **Not Modified**                | **请求的资源未被修改过，可以使用缓存的数据，服务器不会再返回资源**                                                                                              |
| 305     | Use Proxy                       | 使用代理。所请求的资源必须通过代理访问                                                                                                                          |
| 307     | Temporary Redirect              | 临时重定向。与 302 类似。使用 GET 请求重定向                                                                                                                    |
|         |                                 |                                                                                                                                                                 |
| **400** | **Bad Request**                 | **客户端请求的语法错误，服务器无法理解**                                                                                                                        |
| **401** | **Unauthorized**                | **该请求需要用户的身份认证**                                                                                                                                    |
| **403** | **Forbidden**                   | **服务器理解客户端的请求，但是拒绝执行此请求**                                                                                                                  |
| **404** | **Not Found**                   | **服务器找不到客户端请求的资源**<br>前端向不存在的 URL 地址发起请求时，就会返回 404                                                                             |
| 405     | Method Not Allowed              | 客户端请求中的方法被禁止                                                                                                                                        |
| 406     | Not Acceptable                  | 服务器无法根据客户端请求的内容特性完成请求                                                                                                                      |
| 407     | Proxy Authentication Required   | 请求要求代理的身份认证，与 401 类似，但请求者应当使用代理进行授权                                                                                               |
| 408     | Request Time-out                | 服务器等待客户端发送的请求时间过长，超时                                                                                                                        |
| 409     | Conflict                        | 服务器完成客户端的 PUT 请求时可能返回此代码，服务器处理请求时发生了冲突                                                                                         |
| 410     | Gone                            | 客户端请求的资源已经不存在。410 不同于 404，如果资源以前有现在被永久删除了可使用 410 代码，网站设计人员可通过 301 代码指定资源的新位置                          |
| 411     | Length Required                 | 服务器无法处理客户端发送的不带 Content-Length 的请求信息                                                                                                        |
| 412     | Precondition Failed             | 客户端请求信息的先决条件错误                                                                                                                                    |
| 413     | Request Entity Too Large        | 由于请求的实体过大，服务器无法处理，因此拒绝请求。为防止客户端的连续请求，服务器可能会关闭连接。如果只是服务器暂时无法处理，则会包含一个 Retry-After 的响应信息 |
| 414     | Request-URI Too Large           | 请求的 URI 过长（URI 通常为网址），服务器无法处理                                                                                                               |
| 415     | Unsupported Media Type          | 服务器无法处理请求附带的媒体格式                                                                                                                                |
| 416     | Requested range not satisfiable | 客户端请求的范围无效                                                                                                                                            |
| 417     | Expectation Failed              | 服务器无法满足 Expect 的请求头信息                                                                                                                              |
| 429     | Rate Limit                      | 请求过于频繁，被服务器宕掉了                                                                                                                                    |
|         |                                 |                                                                                                                                                                 |
| **500** | **Internal Server Error**       | **服务器内部发生错误**                                                                                                                                          |
| 501     | Not Implemented                 | 服务器不支持请求的功能，无法完成请求。<br>只有 GET、POST 请求是所有浏览器都支持的；<br/>对于其他请求类型，如果浏览器不支持，就会返回 501                        |
| **502** | **Bad Gateway**                 | **作为网关/代理工作的服务器尝试执行请求时，但从远程服务器接收到了一个无效的响应**                                                                               |
| 503     | Service Unavailable             | 由于超载或系统维护，服务器暂时的无法处理客户端的请求。延时的长度可包含在服务器的 Retry-After 头信息中                                                           |
| 504     | Gateway Time-out                | 充当网关或代理的服务器，未及时从远端服务器获取请求                                                                                                              |
| 505     | HTTP Version not supported      | 服务器不支持请求的 HTTP 协议的版本，无法完成处理                                                                                                                |

<br>

## 面试题 ①：301、302、307 有什么区别

-   `301`：永久重定向(Moved Permanently)，该操作比较危险，需要谨慎操作：如果设置了 301，但是一段时间后又想取消，但是浏览器中已经有了缓存，还是会重定向
-   `302`：临时重定向(Found)，但是会在重定向的时候改变 `method`：把 `POST` 改成 `GET`。于是有了 `307`
-   `307`：临时重定向(Temporary Redirect)，在重定向时不会改变 `method`

<br>

## 面试题 ②：502、504 有什么区别

这 2 种异常状态码都与网关 Gateway 有关，首先明确两个概念：

-   Proxy (Gateway)：反向代理层 / 网关层。一般是 Nginx 充当
-   Application (upstream serrver)：应用层服务，作为 Proxy 层的上游服务。一般为各种语言编写的服务器应用

502 和 504 的区别：

-   `502`(Bad Gateway)：一般表现为自己写的应用层服务挂了，网关层无法接收到响应 (也有说 "收到了上游响应但无法解析" 的)
-   `504`(Gateway Timeout)：一般表现为应用层服务超时，即 "上游响应超时"

<br>
