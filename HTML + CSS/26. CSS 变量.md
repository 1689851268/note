# 声明 CSS 变量

-   属性名要以 `--` 开头
-   变量名大小写敏感
-   属性值可以是任何有效的 CSS 值

```css
--font-color: red;
```

-   一个变量的作用域是其对应的选择器的作用范围
-   全局的变量通常放在根伪类 `:root` 里面
    除了优先级更高以外，`:root` 与 `html` 元素选择器相同

```css
/* 声明一个全局变量 */
:root {
    --font-color: red;
}
/* 声明一个局部变量 */
div {
    --bg-color: pink;
}
```

<br><br>

# 使用 CSS 变量

-   在使用 CSS 变量时，使用 `var()` 包裹所需变量的变量名即可：

```css
div {
    color: var(--font-color);
    background-color: var(--bg-color);
}
```

-   `var()` 还可以传第 2 个参数作为 "备用值"；在发现变量值不可访问的情况下，将使用备用值

```css
color: var(--font-color, blue);
```

<br><br>

# CSS 变量的优先级

-   局部变量的优先级 > 全局变量的优先级；
    就是说，如果局部变量与全局变量同名，在局部作用域内，局部变量值会覆盖掉全局变量值

```html
<div>font-size</div>
<p>font-size</p>

<style>
    :root {
        --font-size: 12px;
    }

    div {
        --font-size: 20px;
    }

    div {
        font-size: var(--font-size); /* 为 20px */
    }

    p {
        font-size: var(--font-size); /* 为 12px */
    }
</style>
```

<br><br>

# 在 JS 中使用 CSS 变量

-   使用 CSS 变量的一大好处就是可以在 JavaScript 中访问它

假如通过内联样式来设置 CSS 变量：

```html
<p style="--color: red"></p>
```

```js
// 获取 <p> 元素
const element = document.querySelector('p');

// 检索 CSS 变量 --color
const color = element.style.getPropertyValue('--color');
console.log('color', color); // 'red'
```

如果在 CSS 文件中设置 CSS 变量：

```css
p {
    --color: red;
}
```

```js
// 获取 <p> 元素
const element = document.querySelector('p');

// 获取 CSS 变量 --color
const color = getComputedStyle(element).getPropertyValue('--color');
console.log('color', color); // 'red'
```

可以通过以下形式使用 JavaScript 来设置 CSS 变量：

```js
// 获取 <p> 元素
const element = document.querySelector('p');

// 将 --color 变量设置为 blue
element.style.setProperty('--color', 'blue');
```

<br><br>

# CSS 变量 vs SASS 变量

1. CSS 变量需要以 `--` 为前缀；SASS 变量以 `$` 为前缀
2. 预处理器中的变量的作用域是按大括号块解析的；CSS 变量的作用域是基于 DOM 的，是按元素解析的
3. CSS 变量是动态分配的，支持媒体查询；预处理器中的变量是静态分配的，不支持媒体查询

<br><br>

# demo1

-   我们可以在媒体查询中重新设置变量，这些重新设置的值可以在任何地方使用，这是预处理器变量无法实现的：

```html
<div></div>
<div></div>
<div></div>
<div></div>

<style>
    :root {
        --width: 25%;
        --margin: 20px;
    }

    @media (max-width: 400px) {
        :root {
            --width: 50%;
            --margin: 10px;
        }
    }

    body {
        display: flex;
        flex-wrap: wrap;
    }

    div {
        flex: 1;
        height: 220px;
        flex-basis: calc(var(--width) - (var(--margin) * 3));
        background: #ccc;
        margin: var(--margin);
    }
</style>
```

<br><br>

# demo2

-   CSS 变量使封装成为可能

假如我们有一个按钮，它的 `class` 为 `flat`，代码如下：

```css
button.flat {
    border: 1px solid black;
    background: transparent;
    color: black;
}

button.flat:hover {
    background: black;
    color: white;
}
```

假如我们想要不同的按钮有不同的操作，比如红色的按钮用于危险操作，那么我们就可以使用 `danger` 类来覆盖对应的样式声明：

```css
button.flat.danger {
    border-color: red;
    color: red;
}

button.flat.danger:hover {
    background: red;
    color: white;
}
```

如果有很多种颜色和操作，那就需要多次定义样式来覆盖之前的样式。我们可以使用变量来替换颜色：

```css
button {
    --color-initial: black;
    border: 1px solid var(--color, var(--color-initial));
    background: transparent;
    color: var(--color, var(--color-initial));
}

button:hover {
    background: var(--color, var(--color-initial));
    color: white;
}
```

现在想要主题化这个按钮，只需要定义 `--color` 变量即可：

```css
button.flat.danger {
    --color: red;
}
```

这样就相当于将 CSS 代码进行了封装，代码会简洁很多~

<br><br>

# calc ( ) 函数

`calc()` 函数用一个表达式作为它的参数，用这个表达式的结果作为值

```css
width: calc(100% - 80px);
```

这个表达式可以是任何如下操作符的组合，采用标准操作符处理法则的简单表达式：

1. `+`
2. `-`
3. `*` 乘数中至少有一个是 Number
4. `/` 除数必须是 Number（除数即 `/` 右面的数）

> #### 备注

1. `+` 和 `-` 运算符的两边必须要有空白字符
2. `*` 和 `/` 这两个运算符前后不需要空白字符，但考虑到统一性，仍然推荐加上空白符
3. 用 `0` 作除数会使 HTML 解析器抛出异常
