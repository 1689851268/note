# 媒体标签

对于媒体标签：如果只设置 `width` / `height`，则会等比例缩放资源；如果都设置，则都生效（图片、视频可能会变形）。

<br>

## 图片标签

```html
<img src="" alt="" title="" />
```

1. `src`：图片路径。可以是相对路径 / 绝对路径 / 图像链接。
2. `alt`：图片占位符。当图片显示不出来时，就显示描述的文字。
3. `title`：用于简述图片。当鼠标移动到标签上时，显示 `title` 中描述的文字。
   **注意**：所有标签都可设置 `title` 属性。

<br>

## 音视频标签

```html
<audio src="" controls></audio>
```

```html
<video src="" controls></video>
```

1. `src`：指定资源路径。也可以使用标签内的 `<source>` 元素来指定多个不同格式的音频或视频源，以适应不同浏览器的支持情况。
2. `controls`：是否显示播放控件。
3. `autoplay`：是否自动播放。
4. `loop`：是否循环播放。
5. `preload`：设置资源预加载。可以设置以下属性值：`none`-不预加载、`metadata`-仅预先获取资源的元数据，比如长度、`auto`-可以下载整个资源文件，即使用户不希望使用它。
6. `muted`：是否初始化为静音。
7. `poster`：指定海报帧图片 URL。如果未指定该属性，则在视频第一帧可用之前不会显示任何内容，然后将视频的第一帧作为海报帧来显示。

-   一般来说，常见的音频格式有 mp3、wav、ogg，常见的视频格式有 mp4、webm、ogv。

<br>

出于用户体验的考虑，部分浏览器不支持自动播放视频，还有部分浏览器仅支持静音的情况下自动播放视频。无论如何，都需要用户与浏览器交互之后，视频才能正常播放。

关于 "浏览器自动播放视频问题" 的解决方案：

```html
<div class="container">
    <video
        src="http://clips.vorwaerts-gmbh.de/big_buck_bunny.mp4"
        autoplay
        controls
    ></video>
    <div class="modal">
        <button class="btn">开始播放 / 打开声音</button>
    </div>
</div>
```

```css
.container {
    position: relative;
    text-align: center;
}

.modal {
    background-color: rgba(0, 0, 0, 0.5);
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
}

.btn {
    background-color: #4caf50;
    border: none;
    color: white;
    padding: 16px 32px;
    text-align: center;
    text-decoration: none;
    font-size: 16px;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}

.btn:active {
    filter: brightness(90%);
}

.hide {
    display: none;
}
```

```js
const vdo = document.querySelector('video');
const modal = document.querySelector('.modal');
const btn = document.querySelector('.btn');

// 方法一：引导用户点击播放
async function playVideo() {
    try {
        await vdo.play();
        modal.classList.add('hide');
        btn.removeEventListener('click', playVideo);
    } catch (err) {
        modal.classList.remove('hide');
        btn.addEventListener('click', playVideo);
    }
}

playVideo();
```

```js
// 方法二：先静音播放，引导用户点击取消静音
async function playVideo() {
    vdo.muted = true; // 静音

    const ctx = new AudioContext();
    const canAutoPlay = ctx.state === 'running';
    ctx.close();

    if (canAutoPlay) {
        vdo.muted = false;
        modal.classList.add('hide');
        btn.removeEventListener('click', playVideo);
    } else {
        modal.classList.remove('hide');
        btn.addEventListener('click', playVideo);
    }
}
```

<br>
