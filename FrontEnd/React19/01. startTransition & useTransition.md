# startTransition ä¸ useTransition

ğŸ”— å®˜æ–¹æ–‡æ¡£: [React - startTransition](https://r.1lm.io/p/https://react.dev/reference/react/startTransition), [React - useTransition](https://r.1lm.io/p/https://react.dev/reference/react/useTransition)

`startTransition` å’Œ `useTransition` ç”¨äºæ ‡è®°æŸäº›çŠ¶æ€æ›´æ–°ä¸º**éé˜»å¡çš„ Transition (è¿‡æ¸¡)**, ä»è€Œé˜²æ­¢ç•Œé¢å¡é¡¿.

<br><br>

# startTransition demo

```jsx
import { startTransition, useState } from "react";

function TabContainer() {
    const [tab, setTab] = useState("about");

    function selectTab(nextTab) {
        // startTransition æ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°
        // æ ‡è®°å›è°ƒå‡½æ•°é‡Œé¢çš„çŠ¶æ€æ›´æ–°ä¸ºéé˜»å¡çš„ Transition
        startTransition(() => {
            setTab(nextTab);
        });
    }

    return (
        <div>
            <button onClick={() => selectTab("about")}>About</button>
            <button onClick={() => selectTab("contact")}>Contact</button>
            <div>{tab === "about" ? "About Content" : "Contact Content"}</div>
        </div>
    );
}
```

<br><br>

# useTransition demo

```jsx
import { useState, useTransition } from "react";

function TabContainer() {
    const [tab, setTab] = useState("about");
    // è¿”å›ä¸€ä¸ªæ•°ç»„, åŒ…å« isPending å’Œ startTransition
    // - isPending ç”¨äºæŒ‡ç¤ºæ˜¯å¦æœ‰æœªå®Œæˆçš„ Transition
    // - startTransition ç”¨äºæ ‡è®°æŸäº›çŠ¶æ€æ›´æ–°ä¸ºéé˜»å¡çš„ Transition
    const [isPending, startTransition] = useTransition();

    function selectTab(nextTab) {
        // startTransition æ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°
        // æ ‡è®°å›è°ƒå‡½æ•°é‡Œé¢çš„çŠ¶æ€æ›´æ–°ä¸ºéé˜»å¡çš„ Transition
        startTransition(() => {
            setTab(nextTab);
        });
    }

    return (
        <div>
            <button onClick={() => selectTab("about")} disabled={isPending}>
                About
            </button>
            <button onClick={() => selectTab("contact")} disabled={isPending}>
                Contact
            </button>
            <div>{isPending ? "Loading..." : tab === "about" ? "About Content" : "Contact Content"}</div>
        </div>
    );
}
```

<br><br>

# æ³¨æ„äº‹é¡¹ âš ï¸

âš ï¸ **ä¸èƒ½ç”¨äºæ–‡æœ¬è¾“å…¥æ¡†çš„çŠ¶æ€æ›´æ–°**, å› ä¸ºè¾“å…¥æ¡†çŠ¶æ€åº”å½“åŒæ­¥æ›´æ–°, ä¼šå¯¼è‡´è¾“å…¥å»¶è¿Ÿ.

```jsx
const [text, setText] = useState("");
function handleChange(e) {
    startTransition(() => {
        setText(e.target.value); // âŒ é”™è¯¯ç”¨æ³•: è¾“å…¥ä¼šå˜æ…¢
    });
}
```

âš ï¸ å¦‚æœåœ¨ `await` æ“ä½œåè°ƒç”¨ `setState`, éœ€è¦ **å†åŒ…è£¹ä¸€æ¬¡ `startTransition`**:

```jsx
startTransition(async () => {
    await fetchData();
    startTransition(() => {
        setState(updatedData);
    });
});
```

<br><br>

# é€‚ç”¨åœºæ™¯ ğŸ¯

âœ… ä¼˜åŒ– UI åˆ‡æ¢ (å¦‚ Tabã€Router)
âœ… æœç´¢è¿‡æ»¤
âœ… è¡¨å•æäº¤
âœ… å¤§æ•°æ®æ¸²æŸ“
âœ… é˜²æ­¢ä¸å¿…è¦çš„ Loading æŒ‡ç¤ºå™¨

<br><br>

# ç”¨äº React Router çš„ demo

```jsx
import { useTransition, useState } from "react";

function Router() {
    const [page, setPage] = useState("/");
    const [isPending, startTransition] = useTransition();

    function navigate(url) {
        startTransition(() => {
            setPage(url);
        });
    }

    return (
        <div>
            <button onClick={() => navigate("/")}>Home</button>
            <button onClick={() => navigate("/about")}>About</button>
            <div>{isPending ? "Loading..." : page === "/" ? "Home Page" : "About Page"}</div>
        </div>
    );
}
```

-   ç‚¹å‡»æ—¶, é¡µé¢ä¼šè¿‡æ¸¡åˆ°æ–°çš„ URL, ä½†ä¸ä¼šå¡é¡¿.
-   å¦‚æœè¿‡æ¸¡æ—¶é—´è¿‡é•¿, å¯ä»¥ç”¨ `isPending` æ˜¾ç¤ºåŠ è½½çŠ¶æ€.

<br><br>

# useTransition vs startTransition

| ç‰¹æ€§               | useTransition | startTransition |
| ------------------ | ------------- | --------------- |
| ç”¨æ³•               | Hook          | å‡½æ•°            |
| é€‚ç”¨åœºæ™¯           | ç»„ä»¶å†…éƒ¨      | ä»»ä½•åœ°æ–¹        |
| æ˜¯å¦æœ‰ `isPending` | âœ… æ˜¯         | âŒ å¦           |
| é€‚ç”¨äºè·Ÿè¸ªçŠ¶æ€     | âœ… æ˜¯         | âŒ å¦           |

<br>
