# 业务防范策略

1. 数据加密和接口签名：防止数据在传输过程中被窃取或篡改。

2. 合理设置接口权限：实施严格的身份验证，限制接口访问的范围、权限和频率。

3. 链路完整性和业务逻辑校验：校验用户的关键动作是否具备完整的链路。

4. 输入验证和过滤：不信任任何用户输入的数据，进行有效的输入验证和过滤。

5. 日志记录和定期监控审计：设置监控机制，监视接口请求和响应的行为。

6. 漏洞扫描和安全测试：定期对系统进行漏洞扫描和安全测试，包括渗透测试、代码审计等。

<br><br>

# 接口签名介绍

接口签名可防止参数被篡改，同时加入随机 id 可防止重放攻击。

那么如何进行接口签名呢？

假设我们有如下参数：

```json
{
    "userId": "S123123",
    "rewardCoins": 5,
    "nonce": 123123
}
```

首先，我们以如下形式拼接所有参数成字符串：

```
userId=S123123&rewardCoins=5&nonce=123123
```

然后，和后端约定好使用何种加密算法，如 MD5、SHA256 等，对上述字符串进行加密，得到签名：

```
sign = md5("userId=S123123&rewardCoins=5&nonce=123123") // de4...777
```

最后，将签名和随机 id 一起发送给后端：

```json
{
    "userId": "S123123",
    "rewardCoins": 5,
    "nonce": 123123,
    "sign": "de4...777"
}
```

后端接收到请求后，也会按照同样的规则计算签名，然后对比签名是否一致，来判断参数是否被篡改。

<br>

**破解方式**：逆向 JS 代码，破解签名逻辑，然后伪造请求。

**防护手段**：JS 混淆。在不改变原有逻辑功能的情况下，通过源码转换、字符串加密、函数打乱等混淆方式，将代码变得晦涩难懂，增加破解难度。

<br>
