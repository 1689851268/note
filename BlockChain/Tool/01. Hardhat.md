# Hardhat

Hardhat 是以太坊最流行的开发环境，它可以帮你编译和部署智能合约，并且提供了 Hardhat Network 支持本地测试和运行 Solidity。

```
mkdir hardhat-demo
cd hardhat-demo
pnpm init
pnpm i hardhat -D
npx hardhat
```

```
888    888                      888 888               888
888    888                      888 888               888
888    888                      888 888               888
8888888888  8888b.  888d888 .d88888 88888b.   8888b.  888888
888    888     "88b 888P"  d88" 888 888 "88b     "88b 888
888    888 .d888888 888    888  888 888  888 .d888888 888
888    888 888  888 888    Y88b 888 888  888 888  888 Y88b.
888    888 "Y888888 888     "Y88888 888  888 "Y888888  "Y888

Welcome to Hardhat v2.22.10

? What do you want to do? ...
> Create a JavaScript project
  Create a TypeScript project
  Create a TypeScript project (with Viem)
  Create an empty hardhat.config.js
  Quit
```

这里我选了 Create a JavaScript project，然后会生成 hardhat.config.js：

```js
require("@nomicfoundation/hardhat-toolbox");

/** @type import('hardhat/config').HardhatUserConfig */
module.exports = {
    solidity: "0.8.24",
};
```

这里的 @NomicFoundation/hardhat-toolbox 是一个非常有用的 Hardhat 插件包，它集成了开发智能合约时常用的工具和插件。以下是它的一些主要功能和组件：

-   `hardhat-chai-matchers`：用于在 Hardhat 测试中使用 Chai 匹配器，方便进行断言和测试。

-   `hardhat-ethers`：提供了与 Ethers.js 的集成，方便在 Hardhat 中使用以太坊合约。

-   `hardhat-ignition`：用于快速创建和测试智能合约项目。

-   `hardhat-ignition-ethers`：与 `@nomicfoundation/hardhat-ignition` 一起使用，提供了对 Ethers.js 的额外支持。

-   `hardhat-network-helpers`：包含一些网络相关的助手函数，用于在测试中模拟网络环境。

-   `hardhat-toolbox`：是 Hardhat 的工具包，提供了一些常用的工具和配置。

-   `hardhat-verify`：用于在部署智能合约后进行验证。

<br><br>

# 编写并编译合约

1. 创建 contracts/MyERC20.sol：

```solidity
// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.24;

import "@openzeppelin/contracts/token/ERC20/ERC20.sol";

contract MyERC20 is ERC20 {
    constructor() ERC20("MyERC20", "MY20") {
        _mint(msg.sender, 1000000 * 10 ** decimals());
    }
}
```

2. 执行 `npx hardhat compile` 编译合约：

```
Compiled 7 Solidity files successfully (evm target: paris).
```

编译成功后，你会在文件夹下看到 artifacts 目录，里面的 json 文件就是编译结果。

<br><br>

# 编写单元测试

这里的单元测试非常简单，仅包含部署合约并测试合约地址是否合法。

新建测试文件夹 test，在其中新建 test.js。单元测试中，我们会用到 chai 和 ethers.js 两个库，分别用于测试和链上交互。对 ethers.js 不了解的开发者，可以看下 WTF Ethers 极简教程的前 6 讲。我们之后的教程会更详细的介绍 chai 和 mocha。

1. 创建 test/MyERC20.js:

这里会用到 chai、ethers.js 两个
