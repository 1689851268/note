# äº‹ä»¶ç±»å‹

## é¼ æ ‡äº‹ä»¶

### ç‚¹å‡»äº‹ä»¶

| äº‹ä»¶          | è§¦å‘æ—¶æœº                      | è¯´æ˜                                  |
| ------------- | ----------------------------- | ------------------------------------- |
| `click`       | ç‚¹å‡»å·¦é”® / èšç„¦å…ƒç´ ä¸ŠæŒ‰å›è½¦é”® | ç­‰åŒäº `mousedown` + `mouseup`        |
| `dblclick`    | å·¦é”®åŒå‡»                      | åŒå‡» = 2 æ¬¡ `click` + 1 æ¬¡ `dblclick` |
| `contextmenu` | ç‚¹å‡»å³é”®                      | é€šå¸¸ç”¨äºè‡ªå®šä¹‰å³é”®èœå•                |
| `mousedown`   | æŒ‰ä¸‹é¼ æ ‡ä»»æ„é”®                | å¯é€šè¿‡ `event.button` åŒºåˆ†æŒ‰é”®        |
| `mouseup`     | æŠ¬èµ·é¼ æ ‡ä»»æ„é”®                | -                                     |

```js
// åŒºåˆ†é¼ æ ‡æŒ‰é”®
element.addEventListener("mousedown", (e) => {
    console.log(e.button); // 0: å·¦é”®, 1: ä¸­é”®, 2: å³é”®
});
```

<br>

### ç§»åŠ¨äº‹ä»¶

| äº‹ä»¶         | è§¦å‘æ—¶æœº         | å†’æ³¡          |
| ------------ | ---------------- | ------------- |
| `mouseenter` | é¼ æ ‡è¿›å…¥å…ƒç´      | âŒ            |
| `mouseleave` | é¼ æ ‡ç¦»å¼€å…ƒç´      | âŒ            |
| `mouseover`  | é¼ æ ‡è¿›å…¥å…ƒç´      | âœ…            |
| `mouseout`   | é¼ æ ‡ç¦»å¼€å…ƒç´      | âœ…            |
| `mousemove`  | é¼ æ ‡åœ¨å…ƒç´ ä¸Šç§»åŠ¨ | âœ… (æŒç»­è§¦å‘) |

**`mouseenter` vs `mouseover`:**

-   `mouseenter/mouseleave` ä¸å†’æ³¡, ç§»åˆ°å­å…ƒç´ ä¸Šä¸ä¼šå†æ¬¡è§¦å‘
-   `mouseover/mouseout` ä¼šå†’æ³¡, ç§»åˆ°å­å…ƒç´ ä¸Šä¼šå†æ¬¡è§¦å‘

```js
// æ¨èåœ¨éœ€è¦å¤„ç†å­å…ƒç´ æ—¶ä½¿ç”¨ mouseenter / mouseleave
nav.addEventListener("mouseenter", () => {
    // é¼ æ ‡è¿›å…¥å¯¼èˆªæ , ä¸ä¼šè¢«å­å…ƒç´ å¹²æ‰°
});
```

<br>

### æ»šè½®äº‹ä»¶

**æ ‡å‡†äº‹ä»¶:** `wheel`

```js
element.addEventListener("wheel", (event) => {
    console.log(event.deltaY); // æ­£æ•°: å‘ä¸‹æ»š, è´Ÿæ•°: å‘ä¸Šæ»š
    console.log(event.deltaX); // æ¨ªå‘æ»šåŠ¨
    console.log(event.deltaMode); // 0: åƒç´ , 1: è¡Œ, 2: é¡µ
});
```

**å·²åºŸå¼ƒçš„å±æ€§ (ä»…ä¾›å‚è€ƒ):**

-   `event.wheelDelta` (Chrome/IE): `120` å‘ä¸Š, `-120` å‘ä¸‹
-   `event.detail` (Firefox): `-3` å‘ä¸Š, `3` å‘ä¸‹
-   Firefox æ—§ç‰ˆæœ¬ä½¿ç”¨ `DOMMouseScroll` äº‹ä»¶

**ç°ä»£ä»£ç åº”ä½¿ç”¨ `wheel` äº‹ä»¶å’Œ `deltaY` å±æ€§.**

<br>

## é”®ç›˜äº‹ä»¶

| äº‹ä»¶       | è§¦å‘æ—¶æœº            | æ˜¯å¦é‡å¤è§¦å‘ | å­—ç¬¦é”® | åŠŸèƒ½é”® |
| ---------- | ------------------- | ------------ | ------ | ------ |
| `keydown`  | æŒ‰ä¸‹ä»»æ„é”®          | âœ… (é•¿æŒ‰)    | âœ…     | âœ…     |
| `keyup`    | é‡Šæ”¾ä»»æ„é”®          | âŒ           | âœ…     | âœ…     |
| `keypress` | æŒ‰ä¸‹å­—ç¬¦é”® (å·²åºŸå¼ƒ) | âœ…           | âœ…     | âŒ     |

<br>

### é”®ç›˜å±æ€§

**æ¨èä½¿ç”¨ (ç°ä»£):**

```js
element.addEventListener("keydown", (e) => {
    console.log(e.key); // æŒ‰é”®åç§°: "Enter", "a", "ArrowUp", "Shift"
    console.log(e.code); // ç‰©ç†æŒ‰é”®: "Enter", "KeyA", "ArrowUp", "ShiftLeft"

    // ä¿®é¥°é”®çŠ¶æ€
    console.log(e.ctrlKey); // æ˜¯å¦æŒ‰ä¸‹ Ctrl
    console.log(e.shiftKey); // æ˜¯å¦æŒ‰ä¸‹ Shift
    console.log(e.altKey); // æ˜¯å¦æŒ‰ä¸‹ Alt
    console.log(e.metaKey); // æ˜¯å¦æŒ‰ä¸‹ Meta (Windows é”® / Command é”®)
});
```

**å·²åºŸå¼ƒ (ä»…ä¾›ç†è§£æ—§ä»£ç ):**

-   `e.keyCode`: æ•°å­—ç¼–ç , å¦‚ `13` (Enter),`37` (ArrowLeft),`16` (Shift)

<br>

### å®æˆ˜æ¡ˆä¾‹

**æ¡ˆä¾‹ 1: Ctrl + Enter æäº¤ç•™è¨€**

```js
const input = document.getElementById("messageInput");
const list = document.getElementById("messageList");

input.addEventListener("keydown", (e) => {
    if (e.key === "Enter" && e.ctrlKey) {
        const content = input.value.trim();
        if (!content) return;

        const li = document.createElement("li");
        li.textContent = content;
        list.prepend(li);

        input.value = "";
    }
});
```

<br>

**æ¡ˆä¾‹ 2: æ–¹å‘é”®ç§»åŠ¨å…ƒç´ **

```js
const box = document.getElementById("box");
const step = 10;

document.addEventListener("keydown", (e) => {
    const current = {
        left: box.offsetLeft,
        top: box.offsetTop,
    };

    switch (e.key) {
        case "ArrowLeft":
            box.style.left = current.left - step + "px";
            break;
        case "ArrowUp":
            box.style.top = current.top - step + "px";
            break;
        case "ArrowRight":
            box.style.left = current.left + step + "px";
            break;
        case "ArrowDown":
            box.style.top = current.top + step + "px";
            break;
    }
});
```

<br>

## ç„¦ç‚¹äº‹ä»¶

| äº‹ä»¶       | è§¦å‘æ—¶æœº     | å†’æ³¡ |
| ---------- | ------------ | ---- |
| `focus`    | å…ƒç´ è·å¾—ç„¦ç‚¹ | âŒ   |
| `blur`     | å…ƒç´ å¤±å»ç„¦ç‚¹ | âŒ   |
| `focusin`  | å…ƒç´ è·å¾—ç„¦ç‚¹ | âœ…   |
| `focusout` | å…ƒç´ å¤±å»ç„¦ç‚¹ | âœ…   |

```js
// åœºæ™¯: è¡¨å•éªŒè¯
input.addEventListener("blur", (e) => {
    if (!e.target.value) {
        showError("æ­¤å­—æ®µä¸èƒ½ä¸ºç©º");
    }
});

// åœºæ™¯: äº‹ä»¶å§”æ‰˜ (éœ€è¦å†’æ³¡)
form.addEventListener("focusin", (e) => {
    e.target.parentElement.classList.add("focused");
});
```

<br>

## è¡¨å•äº‹ä»¶

| äº‹ä»¶     | è§¦å‘æ—¶æœº         | é€‚ç”¨å…ƒç´                             |
| -------- | ---------------- | ----------------------------------- |
| `input`  | å€¼æ”¹å˜æ—¶ (å®æ—¶)  | `<input>`, `<textarea>`, `<select>` |
| `change` | å€¼æ”¹å˜ä¸”å¤±å»ç„¦ç‚¹ | åŒä¸Š                                |
| `submit` | è¡¨å•æäº¤         | `<form>`                            |
| `reset`  | è¡¨å•é‡ç½®         | `<form>`                            |
| `select` | æ–‡æœ¬è¢«é€‰ä¸­       | `<input>`, `<textarea>`             |

```js
// input: å®æ—¶æœç´¢
searchInput.addEventListener("input", (e) => {
    search(e.target.value);
});

// change: ä¸‹æ‹‰æ¡†é€‰æ‹©
select.addEventListener("change", (e) => {
    console.log("é€‰ä¸­çš„å€¼:", e.target.value);
});

// submit: è¡¨å•éªŒè¯
form.addEventListener("submit", (e) => {
    e.preventDefault(); // é˜»æ­¢é»˜è®¤æäº¤è¡Œä¸º
    // è‡ªå®šä¹‰æäº¤é€»è¾‘
});
```

<br>

## æ–‡æ¡£/çª—å£äº‹ä»¶

| äº‹ä»¶               | è§¦å‘æ—¶æœº          | ç›®æ ‡                             |
| ------------------ | ----------------- | -------------------------------- |
| `DOMContentLoaded` | HTML è§£æå®Œæˆ     | `document`                       |
| `load`             | èµ„æºå®Œå…¨åŠ è½½      | `window`, `<img>`, `<iframe>` ç­‰ |
| `beforeunload`     | é¡µé¢å³å°†å¸è½½      | `window`                         |
| `unload`           | é¡µé¢å·²å¸è½½        | `window`                         |
| `resize`           | çª—å£/å…ƒç´ å°ºå¯¸æ”¹å˜ | `window`, å…ƒç´                    |
| `scroll`           | æ»šåŠ¨å‘ç”Ÿ          | `window`, å…ƒç´                    |

```js
// DOMContentLoaded: HTML è§£æå®Œæˆ (ä¸ç­‰å¾…å›¾ç‰‡/æ ·å¼)
document.addEventListener("DOMContentLoaded", () => {
    console.log("HTML è§£æå®Œæˆ");
});

// load: èµ„æºå®Œå…¨åŠ è½½
window.addEventListener("load", () => {
    console.log("èµ„æºå®Œå…¨åŠ è½½");
});

// beforeunload: é¡µé¢å³å°†å¸è½½
window.addEventListener("beforeunload", (e) => {
    console.log("é¡µé¢å³å°†å¸è½½");
});
```

<br>

å½“ç”¨æˆ·å…³é—­/åˆ·æ–°/è·³è½¬é¡µé¢æ—¶, å¯ä»¥å¼¹å‡ºç¡®è®¤æ¡†æç¤º:

```js
window.addEventListener("beforeunload", (e) => {
    if (hasUnsavedChanges) {
        e.preventDefault(); // è§¦å‘ç¡®è®¤æ¡†
    }
});
```

**æ³¨æ„äº‹é¡¹:**

-   å¯¹è¯æ¡†å†…å®¹ç”±æµè§ˆå™¨æ§åˆ¶, ä¸èƒ½è‡ªå®šä¹‰
-   åªèƒ½å¼¹å‡ºç¡®è®¤æ¡†, æ— æ³•å¼ºåˆ¶é˜»æ­¢ç”¨æˆ·ç¦»å¼€
-   éœ€è¦ç”¨æˆ·æœ‰è¿‡é¡µé¢äº¤äº’ (ç‚¹å‡»/è¾“å…¥) æ‰ä¼šè§¦å‘

<br><br>

# äº‹ä»¶å¯¹è±¡

å½“äº‹ä»¶è§¦å‘æ—¶, æµè§ˆå™¨ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª **äº‹ä»¶å¯¹è±¡ (Event Object)** å¹¶ä¼ é€’ç»™äº‹ä»¶å¤„ç†å‡½æ•°, è¯¥å¯¹è±¡åŒ…å«äº†æœ¬æ¬¡äº‹ä»¶çš„è¯¦ç»†ä¿¡æ¯.

```js
element.addEventListener("click", (event) => {
    console.log(event); // MouseEvent { type: "click", target: ..., ... }
});
```

<br>

## æ ¸å¿ƒå±æ€§

### äº‹ä»¶åŸºæœ¬ä¿¡æ¯

| å±æ€§            | è¯´æ˜                          | ç¤ºä¾‹                          |
| --------------- | ----------------------------- | ----------------------------- |
| `type`          | äº‹ä»¶ç±»å‹                      | `"click"`, `"keydown"`        |
| `target`        | è§¦å‘äº‹ä»¶çš„å…ƒç´  (äº‹ä»¶æº)       | è¢«ç‚¹å‡»çš„å…·ä½“å…ƒç´               |
| `currentTarget` | ç»‘å®šç›‘å¬å™¨çš„å…ƒç´  (=== `this`) | ç›‘å¬å™¨æ‰€åœ¨çš„å…ƒç´               |
| `eventPhase`    | å½“å‰äº‹ä»¶æµé˜¶æ®µ                | `1`: æ•è·,`2`: ç›®æ ‡,`3`: å†’æ³¡ |
| `isTrusted`     | æ˜¯å¦ä¸ºç”¨æˆ·æ“ä½œè§¦å‘            | `true` / `false`              |
| `timeStamp`     | äº‹ä»¶å‘ç”Ÿçš„æ—¶é—´æˆ³ (ms)         | `12345.67`                    |

**`target` vs `currentTarget`:**

```html
<div id="parent">
    <button id="child">ç‚¹å‡»</button>
</div>

<script>
    parent.addEventListener("click", (e) => {
        console.log(e.target); // <button> (å®é™…ç‚¹å‡»çš„å…ƒç´ )
        console.log(e.currentTarget); // <div> (ç›‘å¬å™¨æ‰€åœ¨çš„å…ƒç´ )
        console.log(e.currentTarget === parent); // true
    });
</script>
```

<br>

### é¼ æ ‡ä½ç½®ä¿¡æ¯

| å±æ€§                 | å‚ç…§ç‰©                     | è¯´æ˜               |
| -------------------- | -------------------------- | ------------------ |
| `offsetX`, `offsetY` | è§¦å‘äº‹ä»¶çš„å…ƒç´ å·¦ä¸Šè§’       | ç›¸å¯¹äºäº‹ä»¶æºçš„åæ ‡ |
| `clientX`, `clientY` | æµè§ˆå™¨å¯è§†åŒºåŸŸå·¦ä¸Šè§’       | ä¸å—é¡µé¢æ»šåŠ¨å½±å“   |
| `pageX`, `pageY`     | æ–‡æ¡£å·¦ä¸Šè§’                 | åŒ…å«æ»šåŠ¨è·ç¦»       |
| `screenX`, `screenY` | å±å¹•å·¦ä¸Šè§’                 | å¤šå±æ—¶ä¼šè·¨è¶Šå±å¹•   |
| `x`,`y`              | `clientX`,`clientY` çš„åˆ«å | -                  |

```js
document.addEventListener("click", (e) => {
    console.log(`å¯è§†åŒºåŸŸåæ ‡: (${e.clientX}, ${e.clientY})`);
    console.log(`é¡µé¢åæ ‡: (${e.pageX}, ${e.pageY})`);
    console.log(`å±å¹•åæ ‡: (${e.screenX}, ${e.screenY})`);
});
```

<br>

### ä¿®é¥°é”®çŠ¶æ€

| å±æ€§       | å¯¹åº”æŒ‰é”®                                  |
| ---------- | ----------------------------------------- |
| `ctrlKey`  | Ctrl é”®                                   |
| `shiftKey` | Shift é”®                                  |
| `altKey`   | Alt é”®                                    |
| `metaKey`  | Meta é”® (Windows å¾½æ ‡é”® / Mac Command é”®) |

```js
element.addEventListener("click", (e) => {
    if (e.ctrlKey) {
        console.log("Ctrl + ç‚¹å‡»");
    }
});
```

<br>

### é¼ æ ‡æŒ‰é”®ä¿¡æ¯

| å±æ€§      | è¯´æ˜                                       |
| --------- | ------------------------------------------ |
| `button`  | æŒ‰ä¸‹çš„é¼ æ ‡æŒ‰é”®: `0` å·¦é”®,`1` ä¸­é”®,`2` å³é”® |
| `buttons` | å½“å‰æŒ‰ä¸‹çš„æ‰€æœ‰æŒ‰é”® (ä½æ©ç )                |

<br>

## æ ¸å¿ƒæ–¹æ³•

### preventDefault

é˜»æ­¢æµè§ˆå™¨çš„é»˜è®¤è¡Œä¸º.

**å¸¸è§é»˜è®¤è¡Œä¸º:**

-   `<a>` çš„ `click`: è·³è½¬é“¾æ¥
-   `<form>` çš„ `submit`: æäº¤è¡¨å•å¹¶åˆ·æ–°é¡µé¢
-   `document` çš„ `contextmenu`: æ˜¾ç¤ºä¸Šä¸‹æ–‡èœå•

```js
// é˜»æ­¢é“¾æ¥è·³è½¬
link.addEventListener("click", (e) => {
    e.preventDefault();
    console.log("é“¾æ¥è¢«ç‚¹å‡», ä½†ä¸è·³è½¬");
});

// é˜»æ­¢è¡¨å•æäº¤
form.addEventListener("submit", (e) => {
    e.preventDefault();
    // è¿›è¡Œè‡ªå®šä¹‰éªŒè¯å’Œ AJAX æäº¤
});

// è‡ªå®šä¹‰å³é”®èœå•
document.addEventListener("contextmenu", (e) => {
    e.preventDefault();
    showCustomMenu(e.clientX, e.clientY);
});
```

<br>

### stopPropagation

é˜»æ­¢äº‹ä»¶åœ¨ DOM æ ‘ä¸­ç»§ç»­ä¼ æ’­ (ä¸å½±å“åŒä¸€å…ƒç´ ä¸Šçš„å…¶ä»–ç›‘å¬å™¨).

```js
parent.addEventListener("click", () => console.log("çˆ¶çº§æ•è·"), true);
child.addEventListener("click", (e) => {
    console.log("å­çº§-1");
    e.stopPropagation(); // â›” é˜»æ­¢äº‹ä»¶ç»§ç»­ä¼ æ’­
});
child.addEventListener("click", () => {
    console.log("å­çº§-2"); // âœ… åŒå…ƒç´ çš„å…¶ä»–ç›‘å¬å™¨ä»ä¼šæ‰§è¡Œ
});
parent.addEventListener("click", () => console.log("çˆ¶çº§å†’æ³¡")); // âŒ ä¸ä¼šæ‰§è¡Œ

// ç‚¹å‡» child, è¾“å‡º: çˆ¶çº§æ•è· â†’ å­çº§-1 â†’ å­çº§-2
```

<br>

### stopImmediatePropagation

ç«‹å³é˜»æ­¢äº‹ä»¶ä¼ æ’­, **åŒæ—¶é˜»æ­¢å½“å‰å…ƒç´ ä¸Šçš„å…¶ä»–ç›‘å¬å™¨**.

```js
child.addEventListener("click", (e) => {
    console.log("ç›‘å¬å™¨ 1");
    e.stopImmediatePropagation(); // ğŸ›‘ ç«‹å³é˜»æ­¢æ‰€æœ‰åç»­æ“ä½œ
});

child.addEventListener("click", () => {
    console.log("ç›‘å¬å™¨ 2"); // âŒ ä¸ä¼šæ‰§è¡Œ
});

parent.addEventListener("click", () => {
    console.log("çˆ¶çº§å†’æ³¡"); // âŒ ä¸ä¼šæ‰§è¡Œ
});

// ç‚¹å‡» element, ä»…è¾“å‡º: ç›‘å¬å™¨ 1
```

**åŠŸèƒ½å¯¹æ¯”è¡¨:**

| æ–¹æ³•                         | é˜»æ­¢äº‹ä»¶ä¼ æ’­ | é˜»æ­¢åŒå…ƒç´ å…¶ä»–ç›‘å¬å™¨ | ä½¿ç”¨åœºæ™¯                    |
| ---------------------------- | ------------ | -------------------- | --------------------------- |
| `stopPropagation()`          | âœ…           | âŒ                   | é˜»æ­¢å†’æ³¡/æ•è·, ä½†ä¸å½±å“åŒçº§ |
| `stopImmediatePropagation()` | âœ…           | âœ…                   | å®Œå…¨é˜»æ­¢äº‹ä»¶çš„åç»­å¤„ç†      |

<br><br>
