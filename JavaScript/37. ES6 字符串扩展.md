# 模板字面量

ES6 新增了使用模板字面量定义字符串的能力。与使用单引号或双引号不同，模板字面量保留换行字符，可以跨行定义字符串：

```js
let myMultiLineString = 'first line\nsecond line';
let myMultiLineTemplateLiteral = `first line
second line`;
console.log(myMultiLineString === myMultiLinetemplateLiteral); // true
```

由于模板字面量会保持反引号内部的空格，因此在使用时要格外注意。

```js
// 这个模板字面量在换行符之后有 24 个空格符
let myTemplateLiteral = `first line
                        second line`;
console.log(myTemplateLiteral.length); // 46

// 这个模板字面量以一个换行符开头
let secondTemplateLiteral = `
    first line
    second line`;
console.log(secondTemplateLiteral[0] === '\n'); // true

// 这个模板字面量没有意料之外的字符
let thirdTemplateLiteral = `first line
    second line`;
console.log(thirdTemplateLiteral);
// first line
//     second line
```

<br>

## 字符串插值

字符串插值通过在 `${}` 中使用一个 JS 表达式实现。

```js
let name = 'superman';
let age = 18;
let str = `
姓名：${name}；
年龄：${age} 岁
`;
console.log(str);
//
// 姓名：superman；
// 年龄：18 岁
//
```

所有插入的值都会使用 `toString()` 强制转型为字符串。

注意：对象转 string 类型，得到的是 `[object Object]`：

```js
console.log(`${{}}`); // [object Object]
```

这时，我们可以重写 `toString()` 方法，以输出我们需要的值

```js
let obj = {
    toString: () => 'World',
};
console.log(`Hello, ${obj}!`); // Hello, World!
```

<br>

## 标签函数

模版字符串作为实际参数来调用的函数 即标签函数。

-   会将模板字符串先处理成多个参数，再调用函数
-   处理逻辑：以 `${}` 为分界点，将分开的字符串组成数组，为第 1 参数；剩下的 `${}` 内的变量，为后续参数

```js
let name = 'superman';
let age = 18;

function output() {
    console.log(arguments);
}

output('姓名：' + name + '；年龄：' + age + '岁'); // { '0': '姓名：superman；年龄：18岁' }
output`姓名：${name}；年龄：${age} 岁`; // { '0': [ '姓名：', '；年龄：', ' 岁' ], '1': 'superman', '2': 18 }
```

-   可以使用剩余操作符 `...` 将 `${}` 内的变量收集到一个数组中：

```js
let name = 'superman';
let age = 18;

function output(template, ...values) {
    console.log(template, values);
}

output`姓名：${name}；年龄：${age} 岁`; // [ '姓名：', '；年龄：', ' 岁' ] [ 'superman', 18 ]
```

<br>

## 原始字符串

可以使用 `String.raw` 标签函数获取原始字符串：

```js
// Unicode 示例
// \u00A9 是版权符号
console.log(`\u00A9`); // ©
console.log(String.raw`\u00A9`); // \u00A9

// 换行符示例
console.log(`first line\nsecond line`);
// first line
// second line
console.log(String.raw`first line\nsecond line`); // "first line\nsecond line"

// 对实际的换行符来说是不行的
// 它们不会被转换成转义序列的形式
console.log(`first line
    second line`);
// first line
//     second line
console.log(String.raw`first line
    second line`);
// first line
//     second line
```

也可以通过标签函数的第一个参数，即字符串数组的 `raw` 属性取得每个字符串的原始内容：

```js
function printRaw(strings) {
    console.log('Actual characters:');
    for (const string of strings) {
        console.log(string);
    }
    console.log('Escaped characters; ');
    for (const rawString of strings.raw) {
        console.log(rawString);
    }
}
printRaw`\u00A9${'and'}\n`;
// Actual characters:
// ©
//（换行符）
// Escaped characters:
// \u00A9
// \n
```

<br><br>

# 新增函数

## includes \*

是否含有参数字符串，返回布尔值。

```js
str.include(substr[, num]);
```

`substr`：查询的字符串；`num`：开始查询的下标，默认为 `0`。

```js
let str = 'apple banana';
console.log(str.indexOf('apple')); // 0

// 从下标为 3 的位置开始查询
console.log(str.includes('apple', 3)); // false
```

<br>

## startsWith

是否以参数字符串为前缀，返回布尔值。

```js
str.startsWith(substr[, num]);
```

`substr`：查询的字符串；`num`：开始查询的下标，默认为 `0`。

```js
let str = 'http://www.baidu.com';
str.startsWith('http'); // true
str.startsWith('https'); // false

// 第 2 参数为开始查询的下标，在此位置上是否以参数字符串开头
str.startsWith('www', 7); // true
```

<br>

## endsWith

是否以参数字符串为后缀，返回布尔值。

```
str.endsWith(substr[, num]);
```

`substr`：查询的字符串；`num`：前几个字符是否以参数字符串结尾。

```js
let str = 'http://www.baidu.com';
str.endsWith('com'); // true
str.endsWith('cn'); // false

// str 的前16个字符是否是以 'baidu' 结尾的
str.endsWith('baidu', 16); // true
```

<br>

## repeat

重复 `num` 次 `str`，`num` 为重复的次数，不能 < `0`。

```js
str.repeat(num);
```

```js
let str = 'superman';
let reStr = str.repeat(2);
console.log(reStr); // supermansuperman
```

<br>

参数注意事项：

1. 参数为 `NaN` 等同于 `0`，`repeat(0)` 返回空字符串 `""`
2. 参数值可以简单地认为是调用了 `parseInt()`，即：
    1. 如果参数是字符串，则会隐式转换成数字
    2. 如果参数是正小数，会向下取整
    3. 如果参数在 `0` ~ `-1` 之间，等同于 `0`
    4. 如果 `参数 <= -1` / `= Infinity`，会报错

<br>

## padStart

添加前缀，返回添加后的字符串。

```js
str.padStart(num[, pStr]);
```

`num`：添加后的长度；`pStr`：添加的字符串，默认为空格。

```js
let str = 'su';
let newStr = str.padStart(5, '666per');
console.log(newStr); // 666su
```

<br>

参数注意事项：

1. 如果 `str.length >= num`，则返回 `str`。
2. 如果 `str.length + pStr.length > num`，会截去超出的 `pStr`。

<br>

我们可以通过 `length` 属性，添加任意长度的前缀：

```js
let str = 'su';
let padStr = '666per'; // 前缀就可以随意改变啦
let newStr = str.padStart(str.length + padStr.length, padStr);
console.log(newStr); // 666persu
```

<br>

## padEnd

添加后缀，返回添加后的字符串。

```
str.padEnd(num, pStr);
```

`num`：填充后的长度；`pStr`：用于填充的字符串。

```js
let str = 'super';
let padStr = 'man';
let newStr = str.padEnd(str.length + padStr.length, padStr);
console.log(newStr); // superman
```

注意事项同 `padStart`。

<br>
