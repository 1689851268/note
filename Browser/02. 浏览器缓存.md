# WebStorage

用于存储数据。

1.  以 key-value 的形式存储在浏览器中。
2.  key-value 的 key 和 value 都只能是 [字符串]，对于 [数字] value，存储时会自动将其转换为 [字符串]。
3.  如果读取的 key 不存在，读取到的 value 会为 `null`；`JSON.parse(null)` 返回 `null`。
4.  web storage 操作为同步操作。

<br>

## SessionStorage

```js
console.log(sessionStorage); // 打印 sessionStorage 对象
sessionStorage.setItem('name', 'superman'); // 存数据
const name = sessionStorage.getItem('name'); // 取数据
sessionStorage.removeItem('name'); // 删除数据
sessionStorage.clear(); // 清空数据
```

<br>

## LocalStorage

```js
console.log(localStorage); // 打印 localStorage 对象
localStorage.setItem('name', 'superman'); // 存数据
const name = localStorage.getItem('name'); // 取数据
localStorage.removeItem('name'); // 删除数据
localStorage.clear(); // 清空数据
```

<br><br>

# Cookie

用于维持 HTTP 的状态。

1. cookie 以 key-value 的形式存储在浏览器中。
2. key-value 的 key 和 value 都只能是 [字符串]。对于 [数字] value，存储时会自动将其转换为 [字符串]。

<br>

浏览器发起请求时，会**自动**把当前域名下所有未过期的 cookie 一同发送到服务器。

为了避免存储过多的 cookie 数据而导致浏览器性能下降和隐私问题，浏览器对于一个域名下可以存放的 cookie 数量都有限制，几十个到上百个不等。当达到浏览器的 cookie 数量限制时，新的 cookie 将会覆盖旧的 cookie。

浏览器对于每个 cookie 的大小也有限制，大约为 4KB。当 cookie 的大小超过浏览器的限制时，浏览器会自动截断 cookie 数据。

<br>

可通过以下方式管理 cookie：

1.  获取所有 cookie：

```js
console.log(document.cookie); // "name=superman; age=18"
```

2.  添加 / 更新指定 cookie：

```js
document.cookie = 'gender=male';
console.log(document.cookie); // "name=superman; age=18; gender=male"
```

<br>

可配置一些用于控制 cookie **有效期**、安全性、适用范围... 的可选属性：

1.  `domain`：cookie 生效的域名；默认为当前域名。
2.  `path`：cookie 生效的路由路径；默认为 `/`。
3.  `expires` / `max-age`：cookie 的有效期；默认为 `会话`，即关闭浏览器就会被销毁。
    `expires` 为指定时间，从 1970-1-1-0-0-0 开始算；`max-age` 为相对时间。

```js
document.cookie = 'age=18; max-age=30'; // 30s 后失效
```

<br>

Cookie 的 path 属性指定了 cookie 适用的 URL 路径，也就是说，只有当用户访问该路径或其子路径时，浏览器才会发送 cookie 到服务器。

如果在前端 JS 代码中设置 cookie 的 path 为根目录（/），意味着该 cookie 对整个网站都有效，无论用户访问哪个页面，都会携带这个 cookie。这样做可能会带来一些安全风险和性能问题，例如：

-   如果 cookie 包含了敏感信息，如用户的登录凭证、个人资料或支付信息，那么任何一个网站的页面都可能读取或修改这些信息，甚至有可能被第三方脚本或恶意代码窃取或篡改。
-   如果 cookie 的大小较大，那么每次用户访问网站的任何页面时，都会增加网络流量和服务器负载，降低网站的响应速度和用户体验。
-   如果网站有多个子域名，如 blog.example.com 和 shop.example.com，那么设置 path 为根目录的 cookie 会在所有子域名之间共享，可能导致数据混乱或冲突。

因此，为了确保网站的安全性和性能，建议不要在前端 JS 代码中设置 cookie 的 path 为根目录（/），而是根据不同的页面和功能，设置合适的 path 属性，使得 cookie 只在需要的范围内有效。这样可以减少 cookie 的暴露和传输，提高网站的安全性和效率。

<br><br>

# Cookie & WebStorage

## 存储大小

1. cookie：大约 4K。
2. sessionStorage：大约 5M。
3. localStorage：大约 5M。

<br>

## 作用域

1. cookie：在同源窗口中共享。
2. sessionStorage：仅在当前 tab 可用。
   但是在某些特定场景下新开的页面会**复制**之前页面的 sessionStorage，比如使用 `a` 标签或 `window.open` 新开页面。
3. localStorage：在同源窗口中共享。

-   同源：协议、域名、端口号都一样；不一样则为跨域。

<br>

## 数据有效期

1. cookie：默认情况下，**关闭浏览器**则失效；可以设置失效时间。
2. sessionStorage：**关闭 tab** 则失效。
3. localStorage：**永久有效**。

<br>

## 通信

1. cookie：能在浏览器与服务器之间来回传递。
2. sessionStorage：不参与通信。
3. localStorage：不参与通信。

<br>
